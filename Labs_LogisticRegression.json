{"paragraphs":[{"text":"%md\n# About\n**Objective:** Become familiar with using Spark MLlib to run Logistic Regression on Hadoop\n**File locations:** spark-labs/weatherAUS.csv\n**Successful outcome:** A trained logistic regression classifier that predicts if it will rain tomorrow\n**Before you begin:**\n**Related lessons:** Supervised learning, Logistic regression\n\n---","user":"admin","dateUpdated":"2019-04-10T09:07:59+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549475_1486429185","id":"20171105-200834_1116095891","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:07:59+0000","dateFinished":"2019-04-10T09:07:59+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:156605"},{"text":"%md\n# Setup\n---","user":"admin","dateUpdated":"2019-04-10T09:07:59+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549476_-2005083345","id":"20181114-164229_902436001","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:00+0000","dateFinished":"2019-04-10T09:08:00+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156606"},{"title":"Retrieve the data from internet and store it in HDFS","text":"%sh\n\nrm -f weatherAUS.csv\nwget -nc -P /home/zeppelin https://s3-us-west-1.amazonaws.com/sci-241/rattle-togaware-weather/weatherAUS.csv\nhdfs dfs -rm spark-labs/weatherAUS.csv\nhdfs dfs -put weatherAUS.csv spark-labs/","user":"admin","dateUpdated":"2019-04-10T09:08:00+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549476_-107893457","id":"20181121-092909_1324039313","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:00+0000","dateFinished":"2019-04-10T09:08:07+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156607"},{"title":"Import libraries","text":"%pyspark\n\nfrom pyspark.ml.feature import StringIndexer\nfrom pyspark.ml.classification import LogisticRegression\nfrom pyspark.ml.evaluation import MulticlassClassificationEvaluator as MCE","user":"admin","dateUpdated":"2019-04-10T09:08:07+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549477_-6954385","id":"20181114-164621_138379904","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:07+0000","dateFinished":"2019-04-10T09:08:07+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156608"},{"text":"%md\n# Lab\n---","user":"admin","dateUpdated":"2019-04-10T09:08:07+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549477_-389712065","id":"20181114-164844_1661453681","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:08+0000","dateFinished":"2019-04-10T09:08:08+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156609"},{"text":"%md\n## Load and inspect the data","user":"admin","dateUpdated":"2019-04-10T09:08:08+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549477_312800570","id":"20181120-105601_996869670","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:08+0000","dateFinished":"2019-04-10T09:08:08+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156610"},{"text":"%md\nFirst we need to load the data into a dataframe using the 'header' and 'inferSchema' options.","user":"admin","dateUpdated":"2019-04-10T09:08:08+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549478_-1614532488","id":"20181120-104302_1071736728","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:08+0000","dateFinished":"2019-04-10T09:08:08+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156611"},{"title":"1 - Load the data into a Spark DataFrame","text":"","user":"admin","dateUpdated":"2019-04-10T09:08:08+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549478_-316816700","id":"20171105-200623_656362182","dateCreated":"2019-01-25T10:29:09+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156612"},{"text":"%md\nWhen doing machine learning, it is important to look at the data you are working with\nUse z.show(data) to view the first 20 rows of your data","user":"admin","dateUpdated":"2019-04-10T09:08:08+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549478_611927406","id":"20171105-201923_413365117","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:08+0000","dateFinished":"2019-04-10T09:08:08+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156613"},{"title":"2 - Inspect the data","text":"","user":"admin","dateUpdated":"2019-04-10T09:08:08+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549478_-1615075959","id":"20171105-201709_849284875","dateCreated":"2019-01-25T10:29:09+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156614"},{"text":"%md\n## Transform the DataFrame into one usable by Spark ML\n\nSpark contains many helper functions, like StringIndexer to convert categorical variables to numerical ones.\nWe will define a function process_data that does all this, and then assembles the data for us.","user":"admin","dateUpdated":"2019-04-10T09:08:08+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549478_-71181506","id":"20171105-201449_1118165660","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:08+0000","dateFinished":"2019-04-10T09:08:08+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156615"},{"text":"%md\n\nCopy and paste the code below in the next paragraph\n~~~\ndef process_data(data):    \n    non_null = data.na.drop(how=\"any\")\n    indexer = StringIndexer(inputCol = 'WindGustDir',outputCol = 'WindGustDir_indexed')\n    indexed1 = indexer.fit(non_null).transform(non_null)\n    indexer = StringIndexer(inputCol = 'WindDir9am', outputCol = 'WindDir9am_indexed')\n    indexed2 = indexer.fit(indexed1).transform(indexed1)\n    indexer = StringIndexer(inputCol = 'WindDir3pm', outputCol = 'WindDir3pm_indexed')\n    indexed3 = indexer.fit(indexed2).transform(indexed2)\n    \n    indexed = indexed3.drop('WindGustDir','WindDir9am','WindDir3pm')\n    \n    feature_columns = list(filter(lambda x: 'Temp' in x or 'WindGust' in x or '9am' in x or '3pm' in x,indexed.columns))\n\n    assembler = VectorAssembler(inputCols=feature_columns, outputCol=\"features\")\n\n    # Transform the data into a form useable by SParkML\n    vectorized = assembler.transform(indexed)\n    indexer = StringIndexer(inputCol = \"RainTomorrow\", outputCol = 'label')\n    labeled  = indexer.fit(vectorized).transform(vectorized)\n    return labeled\n~~~\n\n","user":"admin","dateUpdated":"2019-04-10T09:08:09+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549478_1995660294","id":"20181120-105834_455616424","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:09+0000","dateFinished":"2019-04-10T09:08:09+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156616"},{"title":"3 - Create the process_data function","text":"","user":"admin","dateUpdated":"2019-04-10T09:08:09+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549479_-447277030","id":"20181120-105833_534068450","dateCreated":"2019-01-25T10:29:09+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156617"},{"text":"%md\n\nIn the next cell, call process_data on the data we read in.","user":"admin","dateUpdated":"2019-04-10T09:08:09+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549479_-1852045581","id":"20181121-095645_987622514","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:09+0000","dateFinished":"2019-04-10T09:08:09+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156618"},{"title":"4 - Call the process_data on our data","text":"","user":"admin","dateUpdated":"2019-04-10T09:08:09+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"id":"string","date":"string","price":"string","bedrooms":"string","bathrooms":"string","sqft_living":"string","sqft_lot":"string","floors":"string","waterfront":"string","view":"string","condition":"string","grade":"string","sqft_above":"string","sqft_basement":"string","yr_built":"string","yr_renovated":"string","zipcode":"string","lat":"string","long":"string","sqft_living15":"string","sqft_lot15":"string","features":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549479_-1662793565","id":"20181120-112316_2086924427","dateCreated":"2019-01-25T10:29:09+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156619"},{"title":"5 - Show the label and features columns","text":"","user":"admin","dateUpdated":"2019-04-10T09:08:09+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"label":"string","features":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549479_-2113851075","id":"20181121-103142_733725590","dateCreated":"2019-01-25T10:29:09+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156620"},{"text":"%md\nThis is the data that we will feed to our machine learning algorithm.","user":"admin","dateUpdated":"2019-04-10T09:08:09+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549479_-865041641","id":"20181120-114756_1372220167","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:09+0000","dateFinished":"2019-04-10T09:08:09+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156621"},{"text":"%md\n## Train a model","user":"admin","dateUpdated":"2019-04-10T09:08:09+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549479_-495871919","id":"20181120-142217_940991033","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:10+0000","dateFinished":"2019-04-10T09:08:10+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156622"},{"text":"%md\nNext we need to split this data between a training and a testing set.\nWe will keep \n* 80% of the rows for training and save the other 20% for testing on and\n* use a seed of 228 that will help everyone in the class have similar results.","user":"admin","dateUpdated":"2019-04-10T09:08:10+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549480_1805331206","id":"20181120-142338_951640488","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:10+0000","dateFinished":"2019-04-10T09:08:10+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156623"},{"title":"6 - Split the data into training and test instances","text":"","user":"admin","dateUpdated":"2019-04-10T09:08:10+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549480_-971618812","id":"20181120-142341_921909094","dateCreated":"2019-01-25T10:29:09+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156624"},{"title":"7 - Create an object of the class LogisticRegression with ten iterations","text":"","user":"admin","dateUpdated":"2019-04-10T09:08:10+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549480_-1600358941","id":"20181120-145510_996717762","dateCreated":"2019-01-25T10:29:09+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156625"},{"text":"%md\n\nNow we can train the model on the training data. This may take a few seconds to run.","user":"admin","dateUpdated":"2019-04-10T09:08:10+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549480_1430250111","id":"20181120-145714_1379348985","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:10+0000","dateFinished":"2019-04-10T09:08:10+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156626"},{"title":"8 - Train the model on the training data","text":"","user":"admin","dateUpdated":"2019-04-10T09:08:10+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549480_-627851060","id":"20181120-145719_1439294915","dateCreated":"2019-01-25T10:29:09+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156627"},{"text":"%md\nUse the trained model to make predictions on the test data by calling the 'transform' transformation of the model on the test data.\n","user":"admin","dateUpdated":"2019-04-10T09:08:10+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549481_805250350","id":"20181120-150049_1309747784","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:10+0000","dateFinished":"2019-04-10T09:08:10+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156628"},{"title":"9 - Use the model to make predictions","text":"","user":"admin","dateUpdated":"2019-04-10T09:08:10+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549481_-1886398190","id":"20181120-145938_1249353348","dateCreated":"2019-01-25T10:29:09+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156629"},{"text":"%md\nThe last dataframe now has an extra prediction column\nWe can compare the prediction to the label of a few of the rows in the test set","user":"admin","dateUpdated":"2019-04-10T09:08:10+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549481_-1877757200","id":"20181120-150622_1935248893","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:11+0000","dateFinished":"2019-04-10T09:08:11+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156630"},{"title":"10 - Compare the labels and the predictions","text":"","user":"admin","dateUpdated":"2019-04-10T09:08:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"label":"string","prediction":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549481_-1901097505","id":"20181121-105040_90820119","dateCreated":"2019-01-25T10:29:09+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156631"},{"text":"%md\nCreate an MulticlassClassificationEvaluator (MCE) object and print out the F1 measure\n~~~\nevaluator = MCE()\nprint(evaluator.evaluate(predictions))\n~~~\nYou should see a value of 0.687514124587377.\n","user":"admin","dateUpdated":"2019-04-10T09:08:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549481_891204261","id":"20181121-110924_1701254416","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:11+0000","dateFinished":"2019-04-10T09:08:11+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156632"},{"title":"11 - Create an MCE object and print out the F1 measure","text":"\n","user":"admin","dateUpdated":"2019-04-10T09:08:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549482_1254950224","id":"20181121-111227_1423491342","dateCreated":"2019-01-25T10:29:09+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156633"},{"text":"%md\n\nWe can use Zeppelin's built in features to visualize our labels and predictions.\n\n1. Visualize the predictions dataframe \n2. Use the pivot table feature \n3. Choose the scatter plot visualization\n4. Experiment charting different features against each other\n5. Use either the label or the prediction columns as the group variable\n","user":"admin","dateUpdated":"2019-04-10T09:08:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549482_907985098","id":"20181120-154217_542387411","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:11+0000","dateFinished":"2019-04-10T09:08:11+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156634"},{"title":"12 - Visualize the predictions","text":"","user":"admin","dateUpdated":"2019-04-10T09:08:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"scatterChart","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Date":"string","Location":"string","MinTemp":"string","MaxTemp":"string","Rainfall":"string","Evaporation":"string","Sunshine":"string","WindGustSpeed":"string","WindSpeed9am":"string","WindSpeed3pm":"string","Humidity9am":"string","Humidity3pm":"string","Pressure9am":"string","Pressure3pm":"string","Cloud9am":"string","Cloud3pm":"string","Temp9am":"string","Temp3pm":"string","RainToday":"string","RISK_MM":"string","RainTomorrow":"string","WindGustDir_indexed":"string","WindDir9am_indexed":"string","WindDir3pm_indexed":"string","features":"string","label":"string","group":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"scatterChart":{"xAxis":{"name":"Humidity9am","index":10,"aggr":"sum"},"group":{"name":"prediction","index":26,"aggr":"sum"},"yAxis":{"name":"WindGustSpeed","index":7,"aggr":"sum"}},"pieChart":{}},"keys":[{"name":"Humidity9am","index":10,"aggr":"sum"}],"groups":[{"name":"WindGustSpeed","index":7,"aggr":"sum"}],"values":[{"name":"prediction","index":26,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549482_-1151815354","id":"20181121-112847_1076813012","dateCreated":"2019-01-25T10:29:09+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156635"},{"title":"Bonus","text":"%md\nIf you have extra time, try to improve your model.\n* Combine the assembler and regressor into a Pipeline\n* Go back to step #3 in the notebook and change the columns included as features\n* What happens if we included the binary variable RainToday\n* After editing that cell, run the entire notebook again by hitting the play button at the top","user":"admin","dateUpdated":"2019-04-10T09:08:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549482_1277784768","id":"20181120-152344_1404227962","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:11+0000","dateFinished":"2019-04-10T09:08:11+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156636"},{"text":"%md\n# Result\n**You have now:** You have now successfully trained a logistic regression model for classification and evaluated it using the F1 score.\n\n---","user":"admin","dateUpdated":"2019-04-10T09:08:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549483_1507713280","id":"20181119-142716_792318228","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:11+0000","dateFinished":"2019-04-10T09:08:11+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156637"},{"text":"%md\n# Solution\n---","user":"admin","dateUpdated":"2019-04-10T09:08:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549483_-1655330459","id":"20171113-155535_1769142099","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:11+0000","dateFinished":"2019-04-10T09:08:11+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156638"},{"title":"1 - Load the data into a Spark DataFrame","text":"%pyspark\n\ndata = spark.read.format('csv').option('header',True).option('inferSchema',True).option('nullValue',\"NA\").load('spark-labs/weatherAUS.csv')","user":"admin","dateUpdated":"2019-04-10T09:08:12+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8273","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8274"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408549483_-562220293","id":"20181120-104552_1855149124","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:12+0000","dateFinished":"2019-04-10T09:08:13+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156639"},{"title":"2 - Inspect the data","text":"%pyspark\n\nz.show(data)","user":"admin","dateUpdated":"2019-04-10T09:08:13+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Date":"string","Location":"string","MinTemp":"string","MaxTemp":"string","Rainfall":"string","Evaporation":"string","Sunshine":"string","WindGustDir":"string","WindGustSpeed":"string","WindDir9am":"string","WindDir3pm":"string","WindSpeed9am":"string","WindSpeed3pm":"string","Humidity9am":"string","Humidity3pm":"string","Pressure9am":"string","Pressure3pm":"string","Cloud9am":"string","Cloud3pm":"string","Temp9am":"string","Temp3pm":"string","RainToday":"string","RISK_MM":"string","RainTomorrow":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8275"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408549483_855983546","id":"20181120-104909_658872","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:13+0000","dateFinished":"2019-04-10T09:08:14+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156640"},{"title":"3 - Create the process_data function","text":"%pyspark\n\ndef process_data(data):    \n    non_null = data.na.drop(how=\"any\")\n    indexer = StringIndexer(inputCol = 'WindGustDir',outputCol = 'WindGustDir_indexed')\n    indexed1 = indexer.fit(non_null).transform(non_null)\n    indexer = StringIndexer(inputCol = 'WindDir9am', outputCol = 'WindDir9am_indexed')\n    indexed2 = indexer.fit(indexed1).transform(indexed1)\n    indexer = StringIndexer(inputCol = 'WindDir3pm', outputCol = 'WindDir3pm_indexed')\n    indexed3 = indexer.fit(indexed2).transform(indexed2)\n    \n    indexed = indexed3.drop('WindGustDir','WindDir9am','WindDir3pm')\n    \n    feature_columns = list(filter(lambda x: 'Temp' in x or 'WindGust' in x or '9am' in x or '3pm' in x,indexed.columns))\n\n    assembler = VectorAssembler(inputCols=feature_columns, outputCol=\"features\")\n\n    # Transform the data into a form useable by SParkML\n    vectorized = assembler.transform(indexed)\n    indexer = StringIndexer(inputCol = \"RainTomorrow\", outputCol = 'label')\n    labeled  = indexer.fit(vectorized).transform(vectorized)\n    return labeled","user":"admin","dateUpdated":"2019-04-10T09:08:14+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549487_-639390084","id":"20181121-095946_1151543625","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:14+0000","dateFinished":"2019-04-10T09:08:14+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156641"},{"title":"4 - Call the process_data on our data","text":"%pyspark\n\ncleaned_data = process_data(data)","user":"admin","dateUpdated":"2019-04-10T09:08:14+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"id":"string","date":"string","price":"string","bedrooms":"string","bathrooms":"string","sqft_living":"string","sqft_lot":"string","floors":"string","waterfront":"string","view":"string","condition":"string","grade":"string","sqft_above":"string","sqft_basement":"string","yr_built":"string","yr_renovated":"string","zipcode":"string","lat":"string","long":"string","sqft_living15":"string","sqft_lot15":"string","features":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8276","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8277","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8278","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8279"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408549488_-1068705733","id":"20181121-103252_98019230","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:14+0000","dateFinished":"2019-04-10T09:08:19+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156642"},{"title":"5 - Show the label and features columns","text":"%pyspark\n\nz.show(cleaned_data.select('label','features'))","user":"admin","dateUpdated":"2019-04-10T09:08:19+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"label":"string","features":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8280"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408549488_475247159","id":"20181121-102959_839674579","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:20+0000","dateFinished":"2019-04-10T09:08:21+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156643"},{"title":"6 - Split the data into training and test instances","text":"%pyspark\n\ntrain , test = cleaned_data.randomSplit([0.8,0.2],seed=228)","user":"admin","dateUpdated":"2019-04-10T09:08:21+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549489_-1186814933","id":"20181120-145305_563969576","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:21+0000","dateFinished":"2019-04-10T09:08:21+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156644"},{"title":"7 - Create an object of the class LogisticRegression with ten iterations","text":"%pyspark\n\nclassifier = LogisticRegression(maxIter=10)","user":"admin","dateUpdated":"2019-04-10T09:08:21+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549490_-1328173687","id":"20181120-145610_873155213","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:21+0000","dateFinished":"2019-04-10T09:08:21+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156645"},{"title":"8 - Train the model on the training data","text":"%pyspark\n\nmodel = classifier.fit(train)","user":"admin","dateUpdated":"2019-04-10T09:08:21+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8281","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8282","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8283","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8284","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8285","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8286","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8287","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8288","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8289","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8290","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8291","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8292","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8293","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8294","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8295","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8296","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8297","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8298","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8299","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8300","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8301","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8302","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8303","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8304","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8305","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8306","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8307","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8308","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8309","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8310","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8311","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8312","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8313","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8314","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8315","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8316","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8317","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8318","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8319","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8320","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8321","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8322","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8323","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8324","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8325","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8326","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8327","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8328","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8329","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8330","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8331","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8332","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8333","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8334","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8335","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8336","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8337","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8338","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8339","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8340","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8341","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8342","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8343","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8344","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8345","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8346","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8347","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8348","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8349","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8350","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8351","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8352","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8353","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8354","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8355","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8356","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8357","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8358","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8359","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8360","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8361","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8362","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8363","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8364","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8365","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8366","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8367","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8368","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8369","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8370","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8371","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8372","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8373","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8374","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8375","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8376","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8377","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8378","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8379","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8380","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8381","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8382","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8383","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8384","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8385","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8386","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8387","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8388","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8389","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8390","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8391","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8392","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8393","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8394","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8395","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8396","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8397","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8398","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8399","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8400","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8401","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8402","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8403","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8404","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8405","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8406","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8407","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8408","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8409","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8410","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8411","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8412","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8413","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8414","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8415","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8416","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8417","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8418","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8419","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8420","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8421","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8422","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8423","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8424","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8425","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8426","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8427"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408549490_600116120","id":"20181120-145840_1388968573","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:21+0000","dateFinished":"2019-04-10T09:08:39+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156646"},{"title":"9 - Use the model to make predictions","text":"%pyspark\n\npredictions = model.transform(test)","user":"admin","dateUpdated":"2019-04-10T09:08:39+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549490_501453648","id":"20181120-150448_728157481","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:39+0000","dateFinished":"2019-04-10T09:08:39+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156647"},{"title":"10 - Compare the labels and the predictions","text":"%pyspark\n\nz.show(predictions.select(['label','prediction']))","user":"admin","dateUpdated":"2019-04-10T09:08:39+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"label":"string","prediction":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8428"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408549490_1082982095","id":"20181120-150644_1026223454","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:40+0000","dateFinished":"2019-04-10T09:08:42+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156648"},{"title":"11 - Create an MCE object and print out the F1 measure","text":"%pyspark\n\nevaluator = MCE()\nprint(evaluator.evaluate(predictions))\n","user":"admin","dateUpdated":"2019-04-10T09:08:42+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8429","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8430","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8431"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408549491_6880464","id":"20181120-152222_1366950715","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:42+0000","dateFinished":"2019-04-10T09:08:47+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156649"},{"title":"12 - Visualize the predictions","text":"%pyspark\n\nz.show(predictions)","user":"admin","dateUpdated":"2019-04-10T09:08:47+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"scatterChart","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Date":"string","Location":"string","MinTemp":"string","MaxTemp":"string","Rainfall":"string","Evaporation":"string","Sunshine":"string","WindGustSpeed":"string","WindSpeed9am":"string","WindSpeed3pm":"string","Humidity9am":"string","Humidity3pm":"string","Pressure9am":"string","Pressure3pm":"string","Cloud9am":"string","Cloud3pm":"string","Temp9am":"string","Temp3pm":"string","RainToday":"string","RISK_MM":"string","RainTomorrow":"string","WindGustDir_indexed":"string","WindDir9am_indexed":"string","WindDir3pm_indexed":"string","features":"string","label":"string","group":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"scatterChart":{"xAxis":{"name":"Humidity9am","index":10,"aggr":"sum"},"group":{"name":"prediction","index":28,"aggr":"sum"},"yAxis":{"name":"WindGustSpeed","index":7,"aggr":"sum"}},"pieChart":{}},"keys":[{"name":"Humidity9am","index":10,"aggr":"sum"}],"groups":[{"name":"WindGustSpeed","index":7,"aggr":"sum"}],"values":[{"name":"prediction","index":26,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8432"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408549491_1594724473","id":"20181120-155137_1636863754","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:48+0000","dateFinished":"2019-04-10T09:08:50+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156650"},{"title":"Additional resources","text":"%md\nWe hope you've enjoyed this lab. Below are additional resources that you should find useful:\n\n1. [Hortonworks Apache Spark Tutorials](http://hortonworks.com/tutorials/#tuts-developers) are your natural next step where you can explore Spark in more depth.\n2. [Hortonworks Community Connection (HCC)](https://community.hortonworks.com/spaces/85/data-science.html?type=question) is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.\n3. [Hortonworks Apache Spark Docs](https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/spark-overview/content/analyzing_data_with_apache_spark.html) - official Spark documentation.\n4. [Hortonworks Apache Zeppelin Docs](https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/zeppelin-overview/content/overview.html) - official Zeppelin documentation.","user":"admin","dateUpdated":"2019-04-10T09:08:50+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":10,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549495_323323019","id":"20181116-135131_93712280","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:50+0000","dateFinished":"2019-04-10T09:08:50+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156651"},{"text":"%angular\n</br>\n<center>\n<a href=\"https://learn.hortonworks.com/\">\n  <img src=\"https://everpath-course-content.s3-accelerate.amazonaws.com/instructor%2Ftbroas_hortonworks_c_bsns5k%2Fpublic%2Flogo-training-1.1494860458677.png\" alt=\"Hortonworks University\" style=\"width:125px;height:125px;border:0;\" align=\"middle\">\n</a>\n</center>","user":"admin","dateUpdated":"2019-04-10T09:08:50+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":2,"editorMode":"ace/mode/undefined","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549496_282164406","id":"20181115-083751_61749794","dateCreated":"2019-01-25T10:29:09+0000","dateStarted":"2019-04-10T09:08:51+0000","dateFinished":"2019-04-10T09:08:51+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156652"},{"text":"%angular\n","user":"admin","dateUpdated":"2019-04-10T09:08:51+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/undefined","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408549496_-217917520","id":"20181120-161222_1016896442","dateCreated":"2019-01-25T10:29:09+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:156653"}],"name":"Labs/LogisticRegression","id":"2E187ASFX","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"python:shared_process":[],"angular:shared_process":[],"sh:shared_process":[],"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}