{"paragraphs":[{"text":"%md\n# About\n**Objective:** Become familiar with using Spark MLlib to run Linear Regression for use in classification on Hadoop\n**File locations:** spark-labs/weatherAUS.csv\n**Successful outcome:** A trained linear classifier that predicts if it will rain tomorrow\n**Before you begin:**\n**Related lessons:** Supervised learning, Linear regression\n\n---","user":"admin","dateUpdated":"2019-04-10T09:04:25+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546703_-169481647","id":"20171105-200834_1116095891","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:25+0000","dateFinished":"2019-04-10T09:04:25+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:152257"},{"text":"%md\n# Setup\n---","user":"admin","dateUpdated":"2019-04-10T09:04:25+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546704_-1726871678","id":"20181114-164229_902436001","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:25+0000","dateFinished":"2019-04-10T09:04:25+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152258"},{"title":"Retrieve the data from internet and store it in HDFS","text":"%sh\n\nrm -f weatherAUS.csv\nwget -nc -P /home/zeppelin https://s3-us-west-1.amazonaws.com/sci-241/rattle-togaware-weather/weatherAUS.csv\nhdfs dfs -rm spark-labs/weatherAUS.csv\nhdfs dfs -put weatherAUS.csv spark-labs/","user":"admin","dateUpdated":"2019-04-10T09:04:25+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546704_-274092993","id":"20181121-092909_1324039313","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:25+0000","dateFinished":"2019-04-10T09:04:32+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152259"},{"title":"Import libraries","text":"%pyspark\n\nfrom pyspark.ml.feature import VectorAssembler, StringIndexer\nfrom pyspark.ml.regression import LinearRegression\nfrom pyspark.ml.evaluation import MulticlassClassificationEvaluator as MCE","user":"admin","dateUpdated":"2019-04-10T09:04:32+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546704_1509543348","id":"20181114-164621_138379904","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:32+0000","dateFinished":"2019-04-10T09:04:32+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152260"},{"text":"%md\n# Lab\n---","user":"admin","dateUpdated":"2019-04-10T09:04:33+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546704_1284471518","id":"20181114-164844_1661453681","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:33+0000","dateFinished":"2019-04-10T09:04:33+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152261"},{"text":"%md\n## Load and inspect the data","user":"admin","dateUpdated":"2019-04-10T09:04:33+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546705_762923867","id":"20181120-105601_996869670","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:33+0000","dateFinished":"2019-04-10T09:04:33+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152262"},{"text":"%md\nFirst we need to load the data into a dataframe using the 'header' and 'inferSchema' options.","user":"admin","dateUpdated":"2019-04-10T09:04:33+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546705_396955535","id":"20181120-104302_1071736728","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:33+0000","dateFinished":"2019-04-10T09:04:33+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152263"},{"title":"1 - Load the data into a Spark DataFrame","text":"","user":"admin","dateUpdated":"2019-04-10T09:04:33+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546705_-15692660","id":"20171105-200623_656362182","dateCreated":"2019-01-25T10:29:06+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152264"},{"text":"%md\nWhen doing machine learning, it is important to look at the data you are working with\nUse z.show(data) to view the first 20 rows of your data","user":"admin","dateUpdated":"2019-04-10T09:04:33+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546705_1963970901","id":"20171105-201923_413365117","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:33+0000","dateFinished":"2019-04-10T09:04:33+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152265"},{"title":"2 - Inspect the data","text":"","user":"admin","dateUpdated":"2019-04-10T09:04:34+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546705_-1989281248","id":"20171105-201709_849284875","dateCreated":"2019-01-25T10:29:06+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152266"},{"text":"%md\n## Transform the DataFrame into one usable by Spark ML\n\nSpark contains many helper functions, like StringIndexer to convert categorical variables to numerical ones.\nWe will define a function process_data that does all this, and then assembles the data for us.","user":"admin","dateUpdated":"2019-04-10T09:04:34+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546705_1237128271","id":"20171105-201449_1118165660","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:34+0000","dateFinished":"2019-04-10T09:04:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152267"},{"text":"%md\n\nCopy and paste the code below in the next paragraph\n~~~\ndef process_data(data):    \n    non_null = data.na.drop(how=\"any\")\n    indexer = StringIndexer(inputCol = 'WindGustDir',outputCol = 'WindGustDir_indexed')\n    indexed1 = indexer.fit(non_null).transform(non_null)\n    indexer = StringIndexer(inputCol = 'WindDir9am', outputCol = 'WindDir9am_indexed')\n    indexed2 = indexer.fit(indexed1).transform(indexed1)\n    indexer = StringIndexer(inputCol = 'WindDir3pm', outputCol = 'WindDir3pm_indexed')\n    indexed3 = indexer.fit(indexed2).transform(indexed2)\n    \n    indexed = indexed3.drop('WindGustDir','WindDir9am','WindDir3pm')\n    \n    feature_columns = list(filter(lambda x: 'Temp' in x or 'WindGust' in x or '9am' in x or '3pm' in x,indexed.columns))\n\n    assembler = VectorAssembler(inputCols=feature_columns, outputCol=\"features\")\n\n    # Transform the data into a form useable by SParkML\n    vectorized = assembler.transform(indexed)\n    indexer = StringIndexer(inputCol = \"RainTomorrow\", outputCol = 'label')\n    labeled  = indexer.fit(vectorized).transform(vectorized)\n    return labeled\n~~~\n\n","user":"admin","dateUpdated":"2019-04-10T09:04:34+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546705_-154700430","id":"20181120-105834_455616424","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:34+0000","dateFinished":"2019-04-10T09:04:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152268"},{"title":"3 - Create the process_data function","text":"","user":"admin","dateUpdated":"2019-04-10T09:04:34+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546706_1617612637","id":"20181120-105833_534068450","dateCreated":"2019-01-25T10:29:06+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152269"},{"text":"%md\n\nIn the next cell, call process_data on the data we read in.","user":"admin","dateUpdated":"2019-04-10T09:04:34+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546706_-665328618","id":"20181121-095645_987622514","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:34+0000","dateFinished":"2019-04-10T09:04:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152270"},{"title":"4 - Call the process_data on our data","text":"","user":"admin","dateUpdated":"2019-04-10T09:04:34+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"id":"string","date":"string","price":"string","bedrooms":"string","bathrooms":"string","sqft_living":"string","sqft_lot":"string","floors":"string","waterfront":"string","view":"string","condition":"string","grade":"string","sqft_above":"string","sqft_basement":"string","yr_built":"string","yr_renovated":"string","zipcode":"string","lat":"string","long":"string","sqft_living15":"string","sqft_lot15":"string","features":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546706_1821377897","id":"20181120-112316_2086924427","dateCreated":"2019-01-25T10:29:06+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152271"},{"title":"5 - Show the label and features columns","text":"","user":"admin","dateUpdated":"2019-04-10T09:04:34+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"label":"string","features":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546706_993799572","id":"20181121-103142_733725590","dateCreated":"2019-01-25T10:29:06+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152272"},{"text":"%md\nThis is the data that we will feed to our machine learning algorithm.","user":"admin","dateUpdated":"2019-04-10T09:04:34+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546706_118196358","id":"20181120-114756_1372220167","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:35+0000","dateFinished":"2019-04-10T09:04:35+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152273"},{"text":"%md\n## Train a model","user":"admin","dateUpdated":"2019-04-10T09:04:35+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546706_348423409","id":"20181120-142217_940991033","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:35+0000","dateFinished":"2019-04-10T09:04:35+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152274"},{"text":"%md\nNext we need to split this data between a training and a testing set.\nWe will keep \n* 80% of the rows for training and save the other 20% for testing on and\n* use a seed of 228 that will help everyone in the class have similar results.","user":"admin","dateUpdated":"2019-04-10T09:04:35+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546706_-20031408","id":"20181120-142338_951640488","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:35+0000","dateFinished":"2019-04-10T09:04:35+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152275"},{"title":"6 - Split the data into training and test instances","text":"","user":"admin","dateUpdated":"2019-04-10T09:04:36+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546706_-339581477","id":"20181120-142341_921909094","dateCreated":"2019-01-25T10:29:06+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152276"},{"title":"7 - Create an object of the class LinearRegression with the default parameters","text":"","user":"admin","dateUpdated":"2019-04-10T09:04:36+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546706_1308468033","id":"20181120-145510_996717762","dateCreated":"2019-01-25T10:29:06+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152277"},{"text":"%md\n\nNow we can train the model on the training data. This may take a few seconds to run.","user":"admin","dateUpdated":"2019-04-10T09:04:36+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546707_-910812048","id":"20181120-145714_1379348985","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:36+0000","dateFinished":"2019-04-10T09:04:36+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152278"},{"title":"8 - Train the model on the training data","text":"","user":"admin","dateUpdated":"2019-04-10T09:04:36+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546707_886664666","id":"20181120-145719_1439294915","dateCreated":"2019-01-25T10:29:06+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152279"},{"text":"%md\nUse the trained model to make predictions on the test data by calling the 'transform' transformation of the model on the test data.\n","user":"admin","dateUpdated":"2019-04-10T09:04:36+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546707_345238553","id":"20181120-150049_1309747784","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:36+0000","dateFinished":"2019-04-10T09:04:36+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152280"},{"title":"9 - Use the model to make predictions","text":"","user":"admin","dateUpdated":"2019-04-10T09:04:36+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546707_-664242139","id":"20181120-145938_1249353348","dateCreated":"2019-01-25T10:29:06+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152281"},{"text":"%md\nThe last dataframe now has an extra prediction column\nWe can compare the prediction to the label of a few of the rows in the test set","user":"admin","dateUpdated":"2019-04-10T09:04:36+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546707_-1144698608","id":"20181120-150622_1935248893","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:36+0000","dateFinished":"2019-04-10T09:04:36+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152282"},{"title":"10 - Compare the labels and the predictions","text":"","user":"admin","dateUpdated":"2019-04-10T09:04:36+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"label":"string","prediction":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546707_-769053311","id":"20181121-105040_90820119","dateCreated":"2019-01-25T10:29:06+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152283"},{"text":"%md\nNotice how the prediction is a continuous variable as we are using regression.\nUse the following code to set anything that is greater than or equal to 0.5 to 1, and everything else to 0\n~~~\npredictions = predictions.withColumn(\"prediction\", (predictions['prediction'] >= 0.5).cast('double'))\n~~~","user":"admin","dateUpdated":"2019-04-10T09:04:36+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546707_-344123742","id":"20181120-151457_1794233685","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:36+0000","dateFinished":"2019-04-10T09:04:36+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152284"},{"title":"11 - Convert the predictions to binary labels","text":"","user":"admin","dateUpdated":"2019-04-10T09:04:37+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546707_-1058683570","id":"20181120-151446_1979930885","dateCreated":"2019-01-25T10:29:06+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152285"},{"title":"12 - Compare the labels and the predictions again","text":"","user":"admin","dateUpdated":"2019-04-10T09:04:37+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"label":"string","prediction":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546707_208435598","id":"20181121-110403_655721455","dateCreated":"2019-01-25T10:29:06+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152286"},{"text":"%md\nCreate an MulticlassClassificationEvaluator (MCE) object and print out the F1 measure\n~~~\nevaluator = MCE()\nprint(evaluator.evaluate(predictions))\n~~~\nYou should see a value of 0.832395728182447\n","user":"admin","dateUpdated":"2019-04-10T09:04:37+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546707_249510563","id":"20181121-110924_1701254416","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:37+0000","dateFinished":"2019-04-10T09:04:37+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152287"},{"title":"13 - Create an MCE object and print out the F1 measure","text":"\n","user":"admin","dateUpdated":"2019-04-10T09:04:37+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546708_-166873367","id":"20181121-111227_1423491342","dateCreated":"2019-01-25T10:29:06+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152288"},{"text":"%md\n\nWe can use Zeppelin's built in features to visualize our labels and predictions.\n\n1. Visualize the predictions dataframe \n2. Use the pivot table feature \n3. Choose the scatter plot visualization\n4. Experiment charting different features against each other\n5. Use either the label or the prediction columns as the group variable\n","user":"admin","dateUpdated":"2019-04-10T09:04:37+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546708_-1421656396","id":"20181120-154217_542387411","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:37+0000","dateFinished":"2019-04-10T09:04:37+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152289"},{"title":"14 - Visualize the predictions","text":"","user":"admin","dateUpdated":"2019-04-10T09:04:37+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"scatterChart","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Date":"string","Location":"string","MinTemp":"string","MaxTemp":"string","Rainfall":"string","Evaporation":"string","Sunshine":"string","WindGustSpeed":"string","WindSpeed9am":"string","WindSpeed3pm":"string","Humidity9am":"string","Humidity3pm":"string","Pressure9am":"string","Pressure3pm":"string","Cloud9am":"string","Cloud3pm":"string","Temp9am":"string","Temp3pm":"string","RainToday":"string","RISK_MM":"string","RainTomorrow":"string","WindGustDir_indexed":"string","WindDir9am_indexed":"string","WindDir3pm_indexed":"string","features":"string","label":"string","group":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"scatterChart":{"xAxis":{"name":"Humidity9am","index":10,"aggr":"sum"},"group":{"name":"prediction","index":26,"aggr":"sum"},"yAxis":{"name":"WindGustSpeed","index":7,"aggr":"sum"}},"pieChart":{}},"keys":[{"name":"Humidity9am","index":10,"aggr":"sum"}],"groups":[{"name":"WindGustSpeed","index":7,"aggr":"sum"}],"values":[{"name":"prediction","index":26,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546708_1668364134","id":"20181121-112847_1076813012","dateCreated":"2019-01-25T10:29:06+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152290"},{"title":"Bonus","text":"%md\nIf you have extra time, try to improve your model.\n* Combine the assembler and regressor into a Pipeline\n* Go back to step #3 in the notebook and change the columns included as features\n* What happens if we included the binary variable RainToday\n* After editing that cell, run the entire notebook again by hitting the play button at the top","user":"admin","dateUpdated":"2019-04-10T09:04:37+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546708_-2072588338","id":"20181120-152344_1404227962","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:37+0000","dateFinished":"2019-04-10T09:04:37+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152291"},{"text":"%md\n# Result\n**You have now:** You have now successfully trained a linear model for classification and evaluated it using the F1 score.\n\n---","user":"admin","dateUpdated":"2019-04-10T09:04:37+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546708_-223902638","id":"20181119-142716_792318228","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:37+0000","dateFinished":"2019-04-10T09:04:37+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152292"},{"text":"%md\n# Solution\n---","user":"admin","dateUpdated":"2019-04-10T09:04:37+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546708_1969376438","id":"20171113-155535_1769142099","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:37+0000","dateFinished":"2019-04-10T09:04:37+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152293"},{"title":"1 - Load the data into a Spark DataFrame","text":"%pyspark\n\ndata = spark.read.format('csv').option('header',True).option('inferSchema',True).option('nullValue',\"NA\").load('spark-labs/weatherAUS.csv')","user":"admin","dateUpdated":"2019-04-10T09:04:38+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8254","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8255"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408546708_1702587460","id":"20181120-104552_1855149124","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:38+0000","dateFinished":"2019-04-10T09:04:39+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152294"},{"title":"2 - Inspect the data","text":"%pyspark\n\nz.show(data)","user":"admin","dateUpdated":"2019-04-10T09:04:39+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Date":"string","Location":"string","MinTemp":"string","MaxTemp":"string","Rainfall":"string","Evaporation":"string","Sunshine":"string","WindGustDir":"string","WindGustSpeed":"string","WindDir9am":"string","WindDir3pm":"string","WindSpeed9am":"string","WindSpeed3pm":"string","Humidity9am":"string","Humidity3pm":"string","Pressure9am":"string","Pressure3pm":"string","Cloud9am":"string","Cloud3pm":"string","Temp9am":"string","Temp3pm":"string","RainToday":"string","RISK_MM":"string","RainTomorrow":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8256"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408546709_-1075912312","id":"20181120-104909_658872","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:40+0000","dateFinished":"2019-04-10T09:04:40+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152295"},{"title":"3 - Create the process_data function","text":"%pyspark\n\ndef process_data(data):    \n    non_null = data.na.drop(how=\"any\")\n    indexer = StringIndexer(inputCol = 'WindGustDir',outputCol = 'WindGustDir_indexed')\n    indexed1 = indexer.fit(non_null).transform(non_null)\n    indexer = StringIndexer(inputCol = 'WindDir9am', outputCol = 'WindDir9am_indexed')\n    indexed2 = indexer.fit(indexed1).transform(indexed1)\n    indexer = StringIndexer(inputCol = 'WindDir3pm', outputCol = 'WindDir3pm_indexed')\n    indexed3 = indexer.fit(indexed2).transform(indexed2)\n    \n    indexed = indexed3.drop('WindGustDir','WindDir9am','WindDir3pm')\n    \n    feature_columns = list(filter(lambda x: 'Temp' in x or 'WindGust' in x or '9am' in x or '3pm' in x,indexed.columns))\n\n    assembler = VectorAssembler(inputCols=feature_columns, outputCol=\"features\")\n\n    # Transform the data into a form useable by SParkML\n    vectorized = assembler.transform(indexed)\n    indexer = StringIndexer(inputCol = \"RainTomorrow\", outputCol = 'label')\n    labeled  = indexer.fit(vectorized).transform(vectorized)\n    return labeled","user":"admin","dateUpdated":"2019-04-10T09:04:40+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546712_-378736561","id":"20181121-095946_1151543625","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:41+0000","dateFinished":"2019-04-10T09:04:41+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152296"},{"title":"4 - Call the process_data on our data","text":"%pyspark\n\ncleaned_data = process_data(data)","user":"admin","dateUpdated":"2019-04-10T09:04:41+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"id":"string","date":"string","price":"string","bedrooms":"string","bathrooms":"string","sqft_living":"string","sqft_lot":"string","floors":"string","waterfront":"string","view":"string","condition":"string","grade":"string","sqft_above":"string","sqft_basement":"string","yr_built":"string","yr_renovated":"string","zipcode":"string","lat":"string","long":"string","sqft_living15":"string","sqft_lot15":"string","features":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8257","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8258","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8259","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8260"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408546712_1260927318","id":"20181121-103252_98019230","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:41+0000","dateFinished":"2019-04-10T09:04:46+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152297"},{"title":"5 - Show the label and features columns","text":"%pyspark\n\nz.show(cleaned_data.select('label','features'))","user":"admin","dateUpdated":"2019-04-10T09:04:46+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"label":"string","features":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8261"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408546712_-1643609314","id":"20181121-102959_839674579","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:46+0000","dateFinished":"2019-04-10T09:04:47+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152298"},{"title":"6 - Split the data into training and test instances","text":"%pyspark\n\ntrain , test = cleaned_data.randomSplit([0.8,0.2],seed=228)","user":"admin","dateUpdated":"2019-04-10T09:04:47+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546713_-523540750","id":"20181120-145305_563969576","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:47+0000","dateFinished":"2019-04-10T09:04:47+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152299"},{"title":"7 - Create an object of the class LinearRegression with the default parameters","text":"%pyspark\n\nregressor = LinearRegression()","user":"admin","dateUpdated":"2019-04-10T09:04:47+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546713_-1287072968","id":"20181120-145610_873155213","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:48+0000","dateFinished":"2019-04-10T09:04:48+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152300"},{"title":"8 - Train the model on the training data","text":"%pyspark\n\nmodel = regressor.fit(train)","user":"admin","dateUpdated":"2019-04-10T09:04:48+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8262","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8263","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8264","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8265","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8266"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408546713_1287358836","id":"20181120-145840_1388968573","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:48+0000","dateFinished":"2019-04-10T09:04:57+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152301"},{"title":"9 - Use the model to make predictions","text":"%pyspark\n\npredictions = model.transform(test)","user":"admin","dateUpdated":"2019-04-10T09:04:57+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546713_1128324117","id":"20181120-150448_728157481","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:58+0000","dateFinished":"2019-04-10T09:04:58+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152302"},{"title":"10 - Compare the labels and the predictions","text":"%pyspark\n\nz.show(predictions.select(['label','prediction']))","user":"admin","dateUpdated":"2019-04-10T09:04:58+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"label":"string","prediction":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8267"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408546713_1981926432","id":"20181120-150644_1026223454","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:04:58+0000","dateFinished":"2019-04-10T09:05:00+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152303"},{"title":"11 - Convert the predictions to binary labels","text":"%pyspark\n\npredictions = predictions.withColumn(\"prediction\", (predictions['prediction'] >= 0.5).cast('double'))","user":"admin","dateUpdated":"2019-04-10T09:05:00+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546714_-1245179710","id":"20181121-105507_1035014734","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:05:00+0000","dateFinished":"2019-04-10T09:05:01+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152304"},{"title":"12 - Compare the labels and the predictions again","text":"%pyspark\n\nz.show(predictions.select(['label','prediction']))","user":"admin","dateUpdated":"2019-04-10T09:05:01+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"label":"string","prediction":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8268"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408546714_527177388","id":"20181121-110703_671957067","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:05:01+0000","dateFinished":"2019-04-10T09:05:03+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152305"},{"title":"13 - Create an MCE object and print out the F1 measure","text":"%pyspark\n\nevaluator = MCE()\nprint(evaluator.evaluate(predictions))\n","user":"admin","dateUpdated":"2019-04-10T09:05:03+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8269","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8270","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8271"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408546715_-282551716","id":"20181120-152222_1366950715","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:05:03+0000","dateFinished":"2019-04-10T09:05:08+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152306"},{"title":"14 - Visualize the predictions","text":"%pyspark\n\nz.show(predictions)","user":"admin","dateUpdated":"2019-04-10T09:05:09+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"scatterChart","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Date":"string","Location":"string","MinTemp":"string","MaxTemp":"string","Rainfall":"string","Evaporation":"string","Sunshine":"string","WindGustSpeed":"string","WindSpeed9am":"string","WindSpeed3pm":"string","Humidity9am":"string","Humidity3pm":"string","Pressure9am":"string","Pressure3pm":"string","Cloud9am":"string","Cloud3pm":"string","Temp9am":"string","Temp3pm":"string","RainToday":"string","RISK_MM":"string","RainTomorrow":"string","WindGustDir_indexed":"string","WindDir9am_indexed":"string","WindDir3pm_indexed":"string","features":"string","label":"string","group":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"scatterChart":{"xAxis":{"name":"Humidity9am","index":10,"aggr":"sum"},"group":{"name":"prediction","index":26,"aggr":"sum"},"yAxis":{"name":"WindGustSpeed","index":7,"aggr":"sum"}},"pieChart":{}},"keys":[{"name":"Humidity9am","index":10,"aggr":"sum"}],"groups":[{"name":"WindGustSpeed","index":7,"aggr":"sum"}],"values":[{"name":"prediction","index":26,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8272"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408546715_763523770","id":"20181120-155137_1636863754","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:05:09+0000","dateFinished":"2019-04-10T09:05:11+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152307"},{"title":"Additional resources","text":"%md\nWe hope you've enjoyed this lab. Below are additional resources that you should find useful:\n\n1. [Hortonworks Apache Spark Tutorials](http://hortonworks.com/tutorials/#tuts-developers) are your natural next step where you can explore Spark in more depth.\n2. [Hortonworks Community Connection (HCC)](https://community.hortonworks.com/spaces/85/data-science.html?type=question) is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.\n3. [Hortonworks Apache Spark Docs](https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/spark-overview/content/analyzing_data_with_apache_spark.html) - official Spark documentation.\n4. [Hortonworks Apache Zeppelin Docs](https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/zeppelin-overview/content/overview.html) - official Zeppelin documentation.","user":"admin","dateUpdated":"2019-04-10T09:05:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":10,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546718_1344449988","id":"20181116-135131_93712280","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:05:11+0000","dateFinished":"2019-04-10T09:05:11+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152308"},{"text":"%angular\n</br>\n<center>\n<a href=\"https://learn.hortonworks.com/\">\n  <img src=\"https://everpath-course-content.s3-accelerate.amazonaws.com/instructor%2Ftbroas_hortonworks_c_bsns5k%2Fpublic%2Flogo-training-1.1494860458677.png\" alt=\"Hortonworks University\" style=\"width:125px;height:125px;border:0;\" align=\"middle\">\n</a>\n</center>","user":"admin","dateUpdated":"2019-04-10T09:05:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":2,"editorMode":"ace/mode/undefined","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546718_-1443580164","id":"20181115-083751_61749794","dateCreated":"2019-01-25T10:29:06+0000","dateStarted":"2019-04-10T09:05:11+0000","dateFinished":"2019-04-10T09:05:11+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152309"},{"text":"%angular\n","user":"admin","dateUpdated":"2019-04-10T09:05:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/undefined","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408546718_-807704914","id":"20181120-161222_1016896442","dateCreated":"2019-01-25T10:29:06+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:152310"}],"name":"Labs/LinearRegressionForClassification","id":"2E52EFD6C","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"python:shared_process":[],"angular:shared_process":[],"sh:shared_process":[],"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}