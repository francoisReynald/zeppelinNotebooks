{"paragraphs":[{"text":"%md\n# About\n**Objective:** Understand how to build a SPAM Classifier\n**File locations:** /user/zeppelin/spamEmail\n**Successful outcome:** Classification of spam and ham\n**Before you begin:**\n**Related lessons:** Classification, SPAM Classifier\n\n---","user":"admin","dateUpdated":"2019-03-29T17:50:12+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>About</h1>\n<p><strong>Objective:</strong> Understand how to build a SPAM Classifier\n<br  /><strong>File locations:</strong> /user/zeppelin/spamEmail\n<br  /><strong>Successful outcome:</strong> Classification of spam and ham\n<br  /><strong>Before you begin:</strong>\n<br  /><strong>Related lessons:</strong> Classification, SPAM Classifier</p>\n<hr />\n"}]},"apps":[],"jobName":"paragraph_1548408559875_-1404554465","id":"20181210-180339_918782952","dateCreated":"2019-01-25T10:29:19+0000","dateStarted":"2019-04-10T17:11:54+0000","dateFinished":"2019-04-10T17:11:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:75055"},{"text":"%md\n# Setup\n---","user":"admin","dateUpdated":"2019-02-04T20:58:38+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Setup</h1>\n<hr />\n"}]},"apps":[],"jobName":"paragraph_1548408559875_1244997746","id":"20181210-180901_127134977","dateCreated":"2019-01-25T10:29:19+0000","dateStarted":"2019-04-10T17:11:54+0000","dateFinished":"2019-04-10T17:11:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75056"},{"title":"Retrieve the spam dataset","text":"%sh\nrm -R spamEmail*\nhdfs dfs -rm -R spamEmail\nwget https://s3-us-west-1.amazonaws.com/sci-241/spam-dataset/spamEmail.zip\nunzip spamEmail.zip > out.log\nhdfs dfs -put spamEmail","user":"admin","dateUpdated":"2019-04-09T14:46:20+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"19/04/10 17:11:57 INFO fs.TrashPolicyDefault: Moved: 'hdfs://ip-172-31-13-61.eu-central-1.compute.internal:8020/user/zeppelin/spamEmail' to trash at: hdfs://ip-172-31-13-61.eu-central-1.compute.internal:8020/user/zeppelin/.Trash/Current/user/zeppelin/spamEmail\n--2019-04-10 17:11:57--  https://s3-us-west-1.amazonaws.com/sci-241/spam-dataset/spamEmail.zip\nResolving s3-us-west-1.amazonaws.com (s3-us-west-1.amazonaws.com)... 52.219.24.25\nConnecting to s3-us-west-1.amazonaws.com (s3-us-west-1.amazonaws.com)|52.219.24.25|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 7569418 (7.2M) [application/zip]\nSaving to: ‘spamEmail.zip’\n\n     0K .......... .......... .......... .......... ..........  0%  341K 22s\n    50K .......... .......... .......... .......... ..........  1%  342K 21s\n   100K .......... .......... .......... .......... ..........  2%  342K 21s\n   150K .......... .......... .......... .......... ..........  2% 79.7M 16s\n   200K .......... .......... .......... .......... ..........  3% 89.9M 13s\n   250K .......... .......... .......... .......... ..........  4%  345K 14s\n   300K .......... .......... .......... .......... ..........  4%  103M 12s\n   350K .......... .......... .......... .......... ..........  5%  101M 10s\n   400K .......... .......... .......... .......... ..........  6% 93.7M 9s\n   450K .......... .......... .......... .......... ..........  6%  125M 8s\n   500K .......... .......... .......... .......... ..........  7%  104M 7s\n   550K .......... .......... .......... .......... ..........  8%  347K 8s\n   600K .......... .......... .......... .......... ..........  8% 96.5M 8s\n   650K .......... .......... .......... .......... ..........  9% 55.6M 7s\n   700K .......... .......... .......... .......... .......... 10% 85.6M 6s\n   750K .......... .......... .......... .......... .......... 10%  105M 6s\n   800K .......... .......... .......... .......... .......... 11%  138M 6s\n   850K .......... .......... .......... .......... .......... 12% 99.2M 5s\n   900K .......... .......... .......... .......... .......... 12%  145M 5s\n   950K .......... .......... .......... .......... .......... 13% 92.4M 5s\n  1000K .......... .......... .......... .......... .......... 14% 81.0M 4s\n  1050K .......... .......... .......... .......... .......... 14% 68.4M 4s\n  1100K .......... .......... .......... .......... .......... 15% 36.0M 4s\n  1150K .......... .......... .......... .......... .......... 16% 98.4M 4s\n  1200K .......... .......... .......... .......... .......... 16%  359K 4s\n  1250K .......... .......... .......... .......... .......... 17%  108M 4s\n  1300K .......... .......... .......... .......... .......... 18%  119M 4s\n  1350K .......... .......... .......... .......... .......... 18%  156M 4s\n  1400K .......... .......... .......... .......... .......... 19%  167M 4s\n  1450K .......... .......... .......... .......... .......... 20%  103M 3s\n  1500K .......... .......... .......... .......... .......... 20%  122M 3s\n  1550K .......... .......... .......... .......... .......... 21%  121M 3s\n  1600K .......... .......... .......... .......... .......... 22%  150M 3s\n  1650K .......... .......... .......... .......... .......... 22%  153M 3s\n  1700K .......... .......... .......... .......... .......... 23%  119M 3s\n  1750K .......... .......... .......... .......... .......... 24%  157M 3s\n  1800K .......... .......... .......... .......... .......... 25%  143M 3s\n  1850K .......... .......... .......... .......... .......... 25%  139M 3s\n  1900K .......... .......... .......... .......... .......... 26%  123M 2s\n  1950K .......... .......... .......... .......... .......... 27%  126M 2s\n  2000K .......... .......... .......... .......... .......... 27%  141M 2s\n  2050K .......... .......... .......... .......... .......... 28%  143M 2s\n  2100K .......... .......... .......... .......... .......... 29%  122M 2s\n  2150K .......... .......... .......... .......... .......... 29%  147M 2s\n  2200K .......... .......... .......... .......... .......... 30%  149M 2s\n  2250K .......... .......... .......... .......... .......... 31%  208M 2s\n  2300K .......... .......... .......... .......... .......... 31%  185M 2s\n  2350K .......... .......... .......... .......... .......... 32%  231M 2s\n  2400K .......... .......... .......... .......... .......... 33%  237M 2s\n  2450K .......... .......... .......... .......... .......... 33%  362K 2s\n  2500K .......... .......... .......... .......... .......... 34%  119M 2s\n  2550K .......... .......... .......... .......... .......... 35%  153M 2s\n  2600K .......... .......... .......... .......... .......... 35%  121M 2s\n  2650K .......... .......... .......... .......... .......... 36% 33.9M 2s\n  2700K .......... .......... .......... .......... .......... 37%  121M 2s\n  2750K .......... .......... .......... .......... .......... 37%  142M 2s\n  2800K .......... .......... .......... .......... .......... 38%  198M 2s\n  2850K .......... .......... .......... .......... .......... 39%  164M 2s\n  2900K .......... .......... .......... .......... .......... 39%  134M 2s\n  2950K .......... .......... .......... .......... .......... 40%  153M 2s\n  3000K .......... .......... .......... .......... .......... 41%  147M 1s\n  3050K .......... .......... .......... .......... .......... 41%  128M 1s\n  3100K .......... .......... .......... .......... .......... 42%  124M 1s\n  3150K .......... .......... .......... .......... .......... 43%  149M 1s\n  3200K .......... .......... .......... .......... .......... 43%  147M 1s\n  3250K .......... .......... .......... .......... .......... 44%  161M 1s\n  3300K .......... .......... .......... .......... .......... 45%  134M 1s\n  3350K .......... .......... .......... .......... .......... 45%  141M 1s\n  3400K .......... .......... .......... .......... .......... 46%  150M 1s\n  3450K .......... .......... .......... .......... .......... 47%  149M 1s\n  3500K .......... .......... .......... .......... .......... 48%  115M 1s\n  3550K .......... .......... .......... .......... .......... 48%  144M 1s\n  3600K .......... .......... .......... .......... .......... 49%  137M 1s\n  3650K .......... .......... .......... .......... .......... 50%  196M 1s\n  3700K .......... .......... .......... .......... .......... 50%  181M 1s\n  3750K .......... .......... .......... .......... .......... 51%  231M 1s\n  3800K .......... .......... .......... .......... .......... 52%  243M 1s\n  3850K .......... .......... .......... .......... .......... 52%  219M 1s\n  3900K .......... .......... .......... .......... .......... 53%  208M 1s\n  3950K .......... .......... .......... .......... .......... 54%  254M 1s\n  4000K .......... .......... .......... .......... .......... 54%  254M 1s\n  4050K .......... .......... .......... .......... .......... 55%  262M 1s\n  4100K .......... .......... .......... .......... .......... 56%  194M 1s\n  4150K .......... .......... .......... .......... .......... 56%  266M 1s\n  4200K .......... .......... .......... .......... .......... 57%  247M 1s\n  4250K .......... .......... .......... .......... .......... 58%  254M 1s\n  4300K .......... .......... .......... .......... .......... 58%  213M 1s\n  4350K .......... .......... .......... .......... .......... 59% 71.8M 1s\n  4400K .......... .......... .......... .......... .......... 60%  151M 1s\n  4450K .......... .......... .......... .......... .......... 60%  207M 1s\n  4500K .......... .......... .......... .......... .......... 61%  253M 1s\n  4550K .......... .......... .......... .......... .......... 62%  251M 1s\n  4600K .......... .......... .......... .......... .......... 62%  313M 1s\n  4650K .......... .......... .......... .......... .......... 63%  333M 1s\n  4700K .......... .......... .......... .......... .......... 64%  220M 1s\n  4750K .......... .......... .......... .......... .......... 64%  236M 1s\n  4800K .......... .......... .......... .......... .......... 65%  229M 1s\n  4850K .......... .......... .......... .......... .......... 66%  239M 1s\n  4900K .......... .......... .......... .......... .......... 66%  295M 1s\n  4950K .......... .......... .......... .......... .......... 67%  381K 1s\n  5000K .......... .......... .......... .......... .......... 68%  124M 1s\n  5050K .......... .......... .......... .......... .......... 68%  231M 1s\n  5100K .......... .......... .......... .......... .......... 69%  158M 1s\n  5150K .......... .......... .......... .......... .......... 70%  168M 0s\n  5200K .......... .......... .......... .......... .......... 71%  259M 0s\n  5250K .......... .......... .......... .......... .......... 71%  245M 0s\n  5300K .......... .......... .......... .......... .......... 72% 64.4M 0s\n  5350K .......... .......... .......... .......... .......... 73%  106M 0s\n  5400K .......... .......... .......... .......... .......... 73%  126M 0s\n  5450K .......... .......... .......... .......... .......... 74%  141M 0s\n  5500K .......... .......... .......... .......... .......... 75%  130M 0s\n  5550K .......... .......... .......... .......... .......... 75%  262M 0s\n  5600K .......... .......... .......... .......... .......... 76%  269M 0s\n  5650K .......... .......... .......... .......... .......... 77%  226M 0s\n  5700K .......... .......... .......... .......... .......... 77%  253M 0s\n  5750K .......... .......... .......... .......... .......... 78%  155M 0s\n  5800K .......... .......... .......... .......... .......... 79%  130M 0s\n  5850K .......... .......... .......... .......... .......... 79%  178M 0s\n  5900K .......... .......... .......... .......... .......... 80%  124M 0s\n  5950K .......... .......... .......... .......... .......... 81%  179M 0s\n  6000K .......... .......... .......... .......... .......... 81%  163M 0s\n  6050K .......... .......... .......... .......... .......... 82%  159M 0s\n  6100K .......... .......... .......... .......... .......... 83%  157M 0s\n  6150K .......... .......... .......... .......... .......... 83%  173M 0s\n  6200K .......... .......... .......... .......... .......... 84%  148M 0s\n  6250K .......... .......... .......... .......... .......... 85%  152M 0s\n  6300K .......... .......... .......... .......... .......... 85%  149M 0s\n  6350K .......... .......... .......... .......... .......... 86%  169M 0s\n  6400K .......... .......... .......... .......... .......... 87%  150M 0s\n  6450K .......... .......... .......... .......... .......... 87%  181M 0s\n  6500K .......... .......... .......... .......... .......... 88%  153M 0s\n  6550K .......... .......... .......... .......... .......... 89%  175M 0s\n  6600K .......... .......... .......... .......... .......... 89%  171M 0s\n  6650K .......... .......... .......... .......... .......... 90%  181M 0s\n  6700K .......... .......... .......... .......... .......... 91%  129M 0s\n  6750K .......... .......... .......... .......... .......... 91%  173M 0s\n  6800K .......... .......... .......... .......... .......... 92%  168M 0s\n  6850K .......... .......... .......... .......... .......... 93%  171M 0s\n  6900K .......... .......... .......... .......... .......... 94%  144M 0s\n  6950K .......... .......... .......... .......... .......... 94%  151M 0s\n  7000K .......... .......... .......... .......... .......... 95%  178M 0s\n  7050K .......... .......... .......... .......... .......... 96%  167M 0s\n  7100K .......... .......... .......... .......... .......... 96%  150M 0s\n  7150K .......... .......... .......... .......... .......... 97%  213M 0s\n  7200K .......... .......... .......... .......... .......... 98%  233M 0s\n  7250K .......... .......... .......... .......... .......... 98%  214M 0s\n  7300K .......... .......... .......... .......... .......... 99%  317M 0s\n  7350K .......... .......... .......... .......... ..        100%  359M=1.2s\n\n2019-04-10 17:11:59 (6.09 MB/s) - ‘spamEmail.zip’ saved [7569418/7569418]\n\nreplace __MACOSX/spamEmail/._.DS_Store? [y]es, [n]o, [A]ll, [N]one, [r]ename:  NULL\n(EOF or read error, treating as \"[N]one\" ...)\n"}]},"apps":[],"jobName":"paragraph_1548408559875_-812088682","id":"20181018-151056_296101936","dateCreated":"2019-01-25T10:29:19+0000","dateStarted":"2019-04-10T17:11:54+0000","dateFinished":"2019-04-10T17:12:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75057"},{"text":"%md\n# Demo\n---","user":"admin","dateUpdated":"2019-02-04T20:59:37+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Demo</h1>\n<hr />\n"}]},"apps":[],"jobName":"paragraph_1548408559875_-795039539","id":"20181210-180948_2052412635","dateCreated":"2019-01-25T10:29:19+0000","dateStarted":"2019-04-10T17:12:55+0000","dateFinished":"2019-04-10T17:12:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75058"},{"text":"%md\n## Data engineering","user":"admin","dateUpdated":"2019-02-04T20:59:37+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Data engineering</h2>\n"}]},"apps":[],"jobName":"paragraph_1548408559876_423891254","id":"20181018-163027_1258861763","dateCreated":"2019-01-25T10:29:19+0000","dateStarted":"2019-04-10T17:12:55+0000","dateFinished":"2019-04-10T17:12:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75059"},{"title":"1 - Create an RDD for the datafile that contains the email name and the labels","text":"val labelDoc = sc.textFile(\"spamEmail/SPAM*\")\nlabelDoc.take(1)","user":"admin","dateUpdated":"2019-04-09T14:38:56+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"labelDoc: org.apache.spark.rdd.RDD[String] = spamEmail/SPAM* MapPartitionsRDD[63071] at textFile at <console>:27\nres3: Array[String] = Array(0 TRAIN_00000.eml)\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8998"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408559876_-547407990","id":"20181018-151119_2109423189","dateCreated":"2019-01-25T10:29:19+0000","dateStarted":"2019-04-10T17:12:56+0000","dateFinished":"2019-04-10T17:12:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75060"},{"text":"%md\nThere are two values, the first is a number (0, or 1) which correspond to wether the email with that title is spam or not spam.  If it’s a 0, it is not spam, if it is 1, it is spam.\n\nThe Spark api “wholeTextFiles” will read in all the emails into a PairRdd, where the key is the name of the file and the value is the content of the file.  Do a take on the RDD to get an idea of the structure.  Notice how the key is the entire file path, and in our labelsRdd, we only have the file name.","user":"admin","dateUpdated":"2019-02-04T21:00:16+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>There are two values, the first is a number (0, or 1) which correspond to wether the email with that title is spam or not spam.  If it’s a 0, it is not spam, if it is 1, it is spam.</p>\n<p>The Spark api “wholeTextFiles” will read in all the emails into a PairRdd, where the key is the name of the file and the value is the content of the file.  Do a take on the RDD to get an idea of the structure.  Notice how the key is the entire file path, and in our labelsRdd, we only have the file name.</p>\n"}]},"apps":[],"jobName":"paragraph_1548408559876_990462003","id":"20181018-161147_1192006938","dateCreated":"2019-01-25T10:29:19+0000","dateStarted":"2019-04-10T17:12:56+0000","dateFinished":"2019-04-10T17:12:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75061"},{"title":"2 - Create an RDD for the emails","text":"val spamEmail = sc.wholeTextFiles(\"spamEmail/T*\")\nspamEmail.take(1)","user":"admin","dateUpdated":"2019-04-09T14:39:02+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"spamEmail: org.apache.spark.rdd.RDD[(String, String)] = spamEmail/T* MapPartitionsRDD[63073] at wholeTextFiles at <console>:27\nres4: Array[(String, String)] =\nArray((hdfs://ip-172-31-13-61.eu-central-1.compute.internal:8020/user/zeppelin/spamEmail/TRAIN_00000.eml,\"One of a kind Money maker! Try it for free!From nobody Wed Jul 15 14:06:44 2015\nContent-Type: text/html;\n\tcharset=\"iso-8859-1\"\nContent-Transfer-Encoding: 7bit\n\n<body lang=EN-US>\n\n<div class=Section1>\n\n\n<p class=MsoBodyText style='text-align:justify'><b>CONSANTLY</b> being\nbombarded by so-called �FREE� money-making systems that teases you with limited\ninformation, and when it�s all said and done, blind-sides you by demanding your\nmoney/credit card information upfront in some slick way,<b> after-the-fact</b>!\nYes, I too was as s..."}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8999"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408559876_-903477481","id":"20181018-145338_1421511763","dateCreated":"2019-01-25T10:29:19+0000","dateStarted":"2019-04-10T17:12:56+0000","dateFinished":"2019-04-10T17:13:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75062"},{"text":"%md\nBecause the names in our LabelRdd and spamEmailRdd aren’t the same, we need to massage that data. \nIn order to get only the file name, we need to strip off everything before the last “/” in the key field.  \nTo do so, we’ll use a substring and index function in scala.","user":"admin","dateUpdated":"2019-02-04T21:00:21+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Because the names in our LabelRdd and spamEmailRdd aren’t the same, we need to massage that data.\n<br  />In order to get only the file name, we need to strip off everything before the last “/” in the key field.\n<br  />To do so, we’ll use a substring and index function in scala.</p>\n"}]},"apps":[],"jobName":"paragraph_1548408559877_-571034992","id":"20181018-145459_460976464","dateCreated":"2019-01-25T10:29:19+0000","dateStarted":"2019-04-10T17:13:00+0000","dateFinished":"2019-04-10T17:13:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75063"},{"title":"3 - Clean the files names","text":"val cleanEmailName = spamEmail.map{case (a,b) => ((a.substring(a.lastIndexOf(\"/\")+1)),b)}\ncleanEmailName.take(1)","user":"admin","dateUpdated":"2019-02-04T21:00:21+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"cleanEmailName: org.apache.spark.rdd.RDD[(String, String)] = MapPartitionsRDD[63074] at map at <console>:27\nres5: Array[(String, String)] =\nArray((TRAIN_00000.eml,\"One of a kind Money maker! Try it for free!From nobody Wed Jul 15 14:06:44 2015\nContent-Type: text/html;\n\tcharset=\"iso-8859-1\"\nContent-Transfer-Encoding: 7bit\n\n<body lang=EN-US>\n\n<div class=Section1>\n\n\n<p class=MsoBodyText style='text-align:justify'><b>CONSANTLY</b> being\nbombarded by so-called �FREE� money-making systems that teases you with limited\ninformation, and when it�s all said and done, blind-sides you by demanding your\nmoney/credit card information upfront in some slick way,<b> after-the-fact</b>!\nYes, I too was as skeptical about such offers and the Internet in general with\nall its hype, as you probably are. Fortun..."}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9000"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408559877_-669947528","id":"20181018-161526_795076087","dateCreated":"2019-01-25T10:29:19+0000","dateStarted":"2019-04-10T17:13:00+0000","dateFinished":"2019-04-10T17:13:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75064"},{"text":"%md\nNow that the spamEmailRDD names line up with the labelDocRdd names, we can do a join.\nBut before we join, remember the data in the labelDoc is not in the correct format. So we need fix that.","user":"admin","dateUpdated":"2019-02-04T21:00:22+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Now that the spamEmailRDD names line up with the labelDocRdd names, we can do a join.\n<br  />But before we join, remember the data in the labelDoc is not in the correct format. So we need fix that.</p>\n"}]},"apps":[],"jobName":"paragraph_1548408559877_1706071200","id":"20181018-161918_281630261","dateCreated":"2019-01-25T10:29:19+0000","dateStarted":"2019-04-10T17:13:03+0000","dateFinished":"2019-04-10T17:13:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75065"},{"title":"4 - Clean the labels","text":"val cleanLabelDoc = labelDoc.map(line => line.split(\" \")).map(line => (line(1),line(0)))\r\ncleanLabelDoc.take(1)","user":"admin","dateUpdated":"2019-02-04T21:00:23+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"cleanLabelDoc: org.apache.spark.rdd.RDD[(String, String)] = MapPartitionsRDD[63076] at map at <console>:27\nres6: Array[(String, String)] = Array((TRAIN_00000.eml,0))\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9001"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408559877_1165539688","id":"20181018-162248_1588784583","dateCreated":"2019-01-25T10:29:19+0000","dateStarted":"2019-04-10T17:13:03+0000","dateFinished":"2019-04-10T17:13:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75066"},{"text":"%md\nJoin the two RDD’s together and only keep the values, since the names of the emails aren’t important to us.  \nAlso, this part takes a while as some data is moving around the network.  \nWe want to store a copy of the output data in memory so the rest of this is faster.","user":"admin","dateUpdated":"2019-02-04T21:00:24+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Join the two RDD’s together and only keep the values, since the names of the emails aren’t important to us.\n<br  />Also, this part takes a while as some data is moving around the network.\n<br  />We want to store a copy of the output data in memory so the rest of this is faster.</p>\n"}]},"apps":[],"jobName":"paragraph_1548408559878_-975998534","id":"20181018-162350_1440298394","dateCreated":"2019-01-25T10:29:19+0000","dateStarted":"2019-04-10T17:13:04+0000","dateFinished":"2019-04-10T17:13:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75067"},{"title":"5 - Join the RDDs","text":"val labelsAndEmails = cleanLabelDoc.join(cleanEmailName).values\r\nlabelsAndEmails.take(1)\r\nlabelsAndEmails.cache()\r\nlabelsAndEmails.count()","user":"admin","dateUpdated":"2019-02-04T21:00:24+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"labelsAndEmails: org.apache.spark.rdd.RDD[(String, String)] = MapPartitionsRDD[63080] at values at <console>:33\nres7: Long = 4323\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9002","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9003"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408559878_1034810485","id":"20181018-162552_1797991284","dateCreated":"2019-01-25T10:29:19+0000","dateStarted":"2019-04-10T17:13:04+0000","dateFinished":"2019-04-10T17:13:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75068"},{"text":"%md\n## Data science","user":"admin","dateUpdated":"2019-02-04T21:00:53+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Data science</h2>\n"}]},"apps":[],"jobName":"paragraph_1548408559878_1091895359","id":"20181018-162625_1160463600","dateCreated":"2019-01-25T10:29:19+0000","dateStarted":"2019-04-10T17:13:30+0000","dateFinished":"2019-04-10T17:13:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75069"},{"title":"6 - Import libraries","text":"import org.apache.spark.mllib.regression.LabeledPoint\r\nimport org.apache.spark.mllib.feature.HashingTF\r\nimport org.apache.spark.mllib.classification.LogisticRegressionWithSGD\r\n","user":"admin","dateUpdated":"2019-02-04T21:00:54+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.mllib.regression.LabeledPoint\nimport org.apache.spark.mllib.feature.HashingTF\nimport org.apache.spark.mllib.classification.LogisticRegressionWithSGD\n"}]},"apps":[],"jobName":"paragraph_1548408559879_3072091","id":"20181018-163111_483229022","dateCreated":"2019-01-25T10:29:19+0000","dateStarted":"2019-04-10T17:13:30+0000","dateFinished":"2019-04-10T17:13:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75070"},{"text":"%md\nWe now need to convert our words into numbers, using a HashingTF.\nThis will convert the emails of words into a feature vector of numbers.","user":"admin","dateUpdated":"2019-02-04T21:00:54+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>We now need to convert our words into numbers, using a HashingTF.\n<br  />This will convert the emails of words into a feature vector of numbers.</p>\n"}]},"apps":[],"jobName":"paragraph_1548408559879_-618396767","id":"20181018-163155_604827620","dateCreated":"2019-01-25T10:29:19+0000","dateStarted":"2019-04-10T17:13:31+0000","dateFinished":"2019-04-10T17:13:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75071"},{"title":"7 - Convert the emails of words into a feature vector of numbers","text":"val HTF = new HashingTF(1000000) \r\nval emailFeatures = labelsAndEmails.mapValues(feature => HTF.transform(feature.split(\" \")))\r\nemailFeatures.take(1)","user":"admin","dateUpdated":"2019-02-04T21:00:54+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"HTF: org.apache.spark.mllib.feature.HashingTF = org.apache.spark.mllib.feature.HashingTF@416de405\nemailFeatures: org.apache.spark.rdd.RDD[(String, org.apache.spark.mllib.linalg.Vector)] = MapPartitionsRDD[63081] at mapValues at <console>:39\nres8: Array[(String, org.apache.spark.mllib.linalg.Vector)] = Array((1,(1000000,[6485,12207,20608,20941,27266,32379,44466,54031,62407,67487,71061,74879,81520,83252,88418,111116,131445,131698,149610,158388,161036,171866,189605,203136,206059,212971,220454,221187,241058,250292,255805,263364,273170,274343,292872,301179,317839,335710,346431,355821,358449,376920,414430,414889,417712,424508,429018,429760,451384,469233,482082,491932,502288,502382,522411,523281,529361,529665,542495,545895,554583,560297,564957,585762,592123,593269,593372,596089,620996,623368,6..."}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9004"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408559879_-1071075573","id":"20181018-163640_499701959","dateCreated":"2019-01-25T10:29:19+0000","dateStarted":"2019-04-10T17:13:31+0000","dateFinished":"2019-04-10T17:13:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75072"},{"text":"%md\nNow that we have our features built, we need to label the features.  \nIn addition, this is the last step before we run our machine algorithm, so let's cache the dataset in memory, and take a look at the data.","user":"admin","dateUpdated":"2019-02-04T21:00:56+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Now that we have our features built, we need to label the features.\n<br  />In addition, this is the last step before we run our machine algorithm, so let's cache the dataset in memory, and take a look at the data.</p>\n"}]},"apps":[],"jobName":"paragraph_1548408559879_564855959","id":"20181018-163823_248476231","dateCreated":"2019-01-25T10:29:19+0000","dateStarted":"2019-04-10T17:13:33+0000","dateFinished":"2019-04-10T17:13:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75073"},{"title":"8 - Label the features","text":"val labelsAndFeatures = emailFeatures.map{case (a,b) => LabeledPoint(a.toInt,b)}\nlabelsAndFeatures.take(1)\nlabelsAndFeatures.cache()\nlabelsAndFeatures.count()","user":"admin","dateUpdated":"2019-02-04T21:00:56+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":90,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"labelsAndFeatures: org.apache.spark.rdd.RDD[org.apache.spark.mllib.regression.LabeledPoint] = MapPartitionsRDD[63082] at map at <console>:41\nres9: Long = 4323\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9005","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9006"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408559880_2094521187","id":"20181018-163945_1014096746","dateCreated":"2019-01-25T10:29:19+0000","dateStarted":"2019-04-10T17:13:33+0000","dateFinished":"2019-04-10T17:13:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75074"},{"text":"%md\nNow we have all of our data in the right format, lets build the model.  It may take a couple minutes to build the model","user":"admin","dateUpdated":"2019-02-04T21:00:58+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Now we have all of our data in the right format, lets build the model.  It may take a couple minutes to build the model</p>\n"}]},"apps":[],"jobName":"paragraph_1548408559880_1681593067","id":"20181018-164105_399143427","dateCreated":"2019-01-25T10:29:19+0000","dateStarted":"2019-04-10T17:13:35+0000","dateFinished":"2019-04-10T17:13:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75075"},{"title":"9 - Train the model","text":"val classified = LogisticRegressionWithSGD.train(labelsAndFeatures,100)","user":"admin","dateUpdated":"2019-02-04T21:00:58+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\nclassified: org.apache.spark.mllib.classification.LogisticRegressionModel = org.apache.spark.mllib.classification.LogisticRegressionModel: intercept = 0.0, numFeatures = 1000000, numClasses = 2, threshold = 0.5\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9007","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9008","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9009","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9010","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9011","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9012","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9013","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9014","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9015","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9016","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9017","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9018","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9019","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9020","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9021","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9022","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9023","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9024","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9025","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9026","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9027","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9028","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9029","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9030","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9031","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9032","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9033","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9034","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9035","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9036","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9037","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9038","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9039","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9040","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9041","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9042","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9043","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9044","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9045","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9046","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9047","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9048","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9049","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9050","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9051","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9052","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9053","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9054","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9055","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9056","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9057","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9058","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9059","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9060","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9061","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9062","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9063","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9064","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9065","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9066","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9067","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9068","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9069","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9070","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9071","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9072","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9073","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9074","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9075","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9076","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9077","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9078","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9079","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9080","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9081","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9082","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9083","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9084","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9085","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9086","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9087","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9088","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9089","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9090","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9091","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9092","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9093","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9094","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9095","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9096","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9097","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9098","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9099","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9100","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9101","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9102","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9103","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9104","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9105","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9106","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9107","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9108","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=9109"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408559880_1633077903","id":"20181018-164240_1049678314","dateCreated":"2019-01-25T10:29:19+0000","dateStarted":"2019-04-10T17:13:35+0000","dateFinished":"2019-04-10T17:25:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75076"},{"text":"%md\nThe model is built, we can now start playing with the model and see how it predicts some tests.\nIf the model predicts 0, it is spam, if the model predicts 1, it is not spam.\nLet's test the model with a couple of made up sentences.\nNote, this is not the normal way to test models, but a fun and easy way.","user":"admin","dateUpdated":"2019-02-04T21:01:46+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>The model is built, we can now start playing with the model and see how it predicts some tests.\n<br  />If the model predicts 0, it is spam, if the model predicts 1, it is not spam.\n<br  />Let's test the model with a couple of made up sentences.\n<br  />Note, this is not the normal way to test models, but a fun and easy way.</p>\n"}]},"apps":[],"jobName":"paragraph_1548408559880_1873527856","id":"20181018-164321_1033339833","dateCreated":"2019-01-25T10:29:19+0000","dateStarted":"2019-04-10T17:25:26+0000","dateFinished":"2019-04-10T17:25:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75077"},{"title":"10 - This is spam","text":"val positiveResult = HTF.transform(\"Poker for money against real playersGet your favorite Poker action!\".split(\" \"))\nclassified.predict(positiveResult)\n","user":"admin","dateUpdated":"2019-02-04T21:01:46+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"positiveResult: org.apache.spark.mllib.linalg.Vector = (1000000,[60470,161036,177310,271086,624342,634187,651263,799691,805242],[1.0,1.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0])\nres10: Double = 0.0\n"}]},"apps":[],"jobName":"paragraph_1548408559881_954949037","id":"20181018-164605_495955191","dateCreated":"2019-01-25T10:29:19+0000","dateStarted":"2019-04-10T17:25:27+0000","dateFinished":"2019-04-10T17:25:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75078"},{"title":"11 - This is ham","text":"val negativeResult = HTF.transform(\"Please report to principal's office...\".split(\" \"))\nclassified.predict(negativeResult)","user":"admin","dateUpdated":"2019-02-04T21:01:47+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"negativeResult: org.apache.spark.mllib.linalg.Vector = (1000000,[158388,250925,362633,478488,973477],[1.0,1.0,1.0,1.0,1.0])\nres11: Double = 1.0\n"}]},"apps":[],"jobName":"paragraph_1548408559881_-631930507","id":"20181018-164743_921402864","dateCreated":"2019-01-25T10:29:19+0000","dateStarted":"2019-04-10T17:25:27+0000","dateFinished":"2019-04-10T17:25:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75079"},{"text":"%md\n# Result\n**You have now:** You have successfully seen how to build a SPAM classifier on Spark.\n\n---\n","user":"admin","dateUpdated":"2019-02-04T21:01:48+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Result</h1>\n<p><strong>You have now:</strong> You have successfully seen how to build a SPAM classifier on Spark.</p>\n<hr />\n"}]},"apps":[],"jobName":"paragraph_1548408559881_-630404065","id":"20181018-164847_2144512086","dateCreated":"2019-01-25T10:29:19+0000","dateStarted":"2019-04-10T17:25:29+0000","dateFinished":"2019-04-10T17:25:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75080"},{"text":"%md\nWe hope you've enjoyed this lab. Below are additional resources that you should find useful:\n\n1. [Hortonworks Apache Spark Tutorials](http://hortonworks.com/tutorials/#tuts-developers) are your natural next step where you can explore Spark in more depth.\n2. [Hortonworks Community Connection (HCC)](https://community.hortonworks.com/spaces/85/data-science.html?type=question) is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.\n3. [Hortonworks Apache Spark Docs](https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/spark-overview/content/analyzing_data_with_apache_spark.html) - official Spark documentation.\n4. [Hortonworks Apache Zeppelin Docs](https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/zeppelin-overview/content/overview.html) - official Zeppelin documentation.","user":"admin","dateUpdated":"2019-02-04T21:01:48+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":10,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>We hope you've enjoyed this lab. Below are additional resources that you should find useful:</p>\n<ol>\n<li><a href=\"http://hortonworks.com/tutorials/#tuts-developers\">Hortonworks Apache Spark Tutorials</a> are your natural next step where you can explore Spark in more depth.</li>\n<li><a href=\"https://community.hortonworks.com/spaces/85/data-science.html?type=question\">Hortonworks Community Connection (HCC)</a> is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.</li>\n<li><a href=\"https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/spark-overview/content/analyzing_data_with_apache_spark.html\">Hortonworks Apache Spark Docs</a> - official Spark documentation.</li>\n<li><a href=\"https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/zeppelin-overview/content/overview.html\">Hortonworks Apache Zeppelin Docs</a> - official Zeppelin documentation.</li>\n</ol>\n"}]},"apps":[],"jobName":"paragraph_1548408559882_290810653","id":"20181210-182104_578545004","dateCreated":"2019-01-25T10:29:19+0000","dateStarted":"2019-04-10T17:25:29+0000","dateFinished":"2019-04-10T17:25:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75081"},{"text":"%angular\n</br>\n<center>\n<a href=\"https://learn.hortonworks.com/\">\n  <img src=\"https://everpath-course-content.s3-accelerate.amazonaws.com/instructor%2Ftbroas_hortonworks_c_bsns5k%2Fpublic%2Flogo-training-1.1494860458677.png\" alt=\"Hortonworks University\" style=\"width:125px;height:125px;border:0;\" align=\"middle\">\n</a>\n</center>","user":"admin","dateUpdated":"2019-02-04T21:01:48+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":2,"editorMode":"ace/mode/undefined","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"ANGULAR","data":"</br>\n<center>\n<a href=\"https://learn.hortonworks.com/\">\n  <img src=\"https://everpath-course-content.s3-accelerate.amazonaws.com/instructor%2Ftbroas_hortonworks_c_bsns5k%2Fpublic%2Flogo-training-1.1494860458677.png\" alt=\"Hortonworks University\" style=\"width:125px;height:125px;border:0;\" align=\"middle\">\n</a>\n</center>"}]},"apps":[],"jobName":"paragraph_1548408559882_-105760052","id":"20181210-182216_1029115406","dateCreated":"2019-01-25T10:29:19+0000","dateStarted":"2019-04-10T17:25:29+0000","dateFinished":"2019-04-10T17:25:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75082"},{"text":"%angular\n","user":"admin","dateUpdated":"2019-02-04T21:01:51+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/undefined","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408559882_2129928841","id":"20181210-182249_423337808","dateCreated":"2019-01-25T10:29:19+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:75083"}],"name":"Demos/CreateASPAMClassifier","id":"2E3ABKDXA","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"python:shared_process":[],"angular:shared_process":[],"sh:shared_process":[],"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}